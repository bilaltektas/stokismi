<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stok Asistani</title>
<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0b1220;
  color:#e6f0ff;
}
.app{
  max-width:480px;
  margin:auto;
  padding:20px;
}
h1{
  text-align:center;
  color:#38bdf8;
}
#mic{
  width:90px;
  height:90px;
  border-radius:50%;
  background:#0ea5e9;
  margin:20px auto;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:40px;
  cursor:pointer;
}
#mic.listening{
  animation:pulse 1s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 10px #38bdf8}
  50%{box-shadow:0 0 30px #38bdf8}
  100%{box-shadow:0 0 10px #38bdf8}
}
input{
  width:100%;
  padding:12px;
  font-size:16px;
  border-radius:10px;
  border:none;
}
#out{
  margin-top:15px;
  background:#020617;
  padding:15px;
  border-radius:10px;
  min-height:80px;
}
</style>
</head>

<body>
<div class="app">
  <h1>ğŸ™ï¸ Stok Asistani</h1>

  <div id="mic">ğŸ¤</div>

  <input id="txt" placeholder="Stok kodu, Ã¼rÃ¼n adÄ± veya sohbet yaz..." />

  <div id="out">HazÄ±rÄ±m.</div>
</div>

<script>
// ================= VERI =================
const STOCKS = [
  {
    grup: "MAMUL",
    kod: "00201306090",
    ad: "ACI BÄ°BER 100 LUK TÃœM 100 G ORTA PET (K332)"
  }
];

// ================= SES =================
function speak(text){
  if(!window.speechSynthesis) return;
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "tr-TR";
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

// ================= AKAN YAZI =================
function write(text){
  out.innerText = "";
  let i = 0;
  const t = setInterval(()=>{
    out.innerText += text[i];
    i++;
    if(i >= text.length) clearInterval(t);
  }, 20);
}

// ================= SAYI OKUMA =================
const birler = ["","bir","iki","Ã¼Ã§","dÃ¶rt","beÅŸ","altÄ±","yedi","sekiz","dokuz"];
const onlar = ["","on","yirmi","otuz","kÄ±rk","elli","altmÄ±ÅŸ","yetmiÅŸ","seksen","doksan"];

function ikiHane(n){
  if(n[0]==="0") return "sÄ±fÄ±r " + birler[n[1]];
  return onlar[n[0]] + (n[1]!=="0" ? " " + birler[n[1]] : "");
}

function stokKoduOku(kod){
  let sonuc = [];
  for(let i=0;i<kod.length;i+=2){
    sonuc.push(ikiHane(kod.substring(i,i+2)));
  }
  return sonuc.join(" , ");
}

// ================= ANALIZ =================
function analyze(q){
  q = q.toLowerCase();

  // sohbet
  if(q.includes("nasÄ±lsÄ±n")){
    const t = "Ä°yiyim, teÅŸekkÃ¼r ederim. Sana stok bilgisi verebilirim.";
    write(t);
    speak(t);
    return;
  }

  let found = null;
  STOCKS.forEach(s=>{
    if(q.includes(s.kod) || s.ad.toLowerCase().includes(q)){
      found = s;
    }
  });

  if(!found){
    write("EÅŸleÅŸme bulamadÄ±m. Tekrar dener misin?");
    speak("EÅŸleÅŸme bulamadÄ±m.");
    return;
  }

  const okunanKod = stokKoduOku(found.kod);
  const text = `${found.grup}. Stok kodu ${okunanKod}. ÃœrÃ¼n ${found.ad}.`;
  write(text);
  speak(text);
}

// ================= MANUEL =================
txt.addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    analyze(e.target.value);
    txt.value="";
  }
});

// ================= MIKROFON =================
const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
if(SR){
  const rec = new SR();
  rec.lang = "tr-TR";

  mic.onclick = ()=>{
    mic.classList.add("listening");
    rec.start();
  };

  rec.onresult = e=>{
    mic.classList.remove("listening");
    analyze(e.results[0][0].transcript);
  };

  rec.onerror = ()=>{
    mic.classList.remove("listening");
    write("Mikrofon eriÅŸimi reddedildi. YazÄ± ile deneyebilirsin.");
  };
}
</script>
</body>
</html>
