<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sesli Stok Asistani</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:radial-gradient(circle at top,#020617,#000);
  color:#e0f2ff;
  text-align:center;
}
h1{margin-top:20px;color:#38bdf8}

#mic{
  width:120px;height:120px;
  border-radius:50%;
  margin:30px auto;
  background:linear-gradient(145deg,#0ea5e9,#0369a1);
  display:flex;align-items:center;justify-content:center;
  font-size:48px;cursor:pointer;
  box-shadow:0 0 25px #38bdf8;
  animation:pulse 2s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 15px #38bdf8}
  50%{box-shadow:0 0 40px #38bdf8}
  100%{box-shadow:0 0 15px #38bdf8}
}

#result{
  max-width:500px;
  margin:20px auto;
  background:#020617;
  border-radius:14px;
  padding:20px;
  font-size:16px;
  box-shadow:inset 0 0 15px #38bdf855;
}
</style>
</head>

<body>

<h1>üéôÔ∏è Sesli Stok Asistani</h1>
<div id="mic">üé§</div>
<div id="result">Mikrofona dokun ve konu≈ü</div>

<script>
// ====== VERI (GOMULU) ======
const DATA = [
 {g:"HAMMADDE",k:"004070201",a:"AKBIBER TANE 25 KG PP CUVAL"},
 {g:"MAMUL",k:"0800223",a:"BAHARAT KIMYON 75 GR DESTAN"},
 {g:"AMBALAJ",k:"06005",a:"SANITA JOKER KUSUZUMU 126X380X133"},
];

// ====== TURKCE SAYI ======
const ones=["","bir","iki","uc","dort","bes","alti","yedi","sekiz","dokuz"];
const tens=["","on","yirmi","otuz","kirk","elli","altmis","yetmis","seksen","doksan"];

function readNumber(n){
  if(n==="0") return "sifir";
  let s="";
  if(n.length===3){
    if(n[0]!=="0") s+=ones[n[0]]+" yuz ";
    n=n.slice(1);
  }
  if(n.length===2){
    s+=tens[n[0]]+" ";
    if(n[1]!=="0") s+=ones[n[1]];
  }
  return s.trim();
}

function readStockCode(code){
  let groups=[];
  for(let i=0;i<code.length;i+=2){
    groups.push(code.substring(i,i+2));
  }
  return groups.map(g=>{
    if(g.startsWith("0")) return "sifir "+ones[g[1]];
    return readNumber(g);
  }).join(" , ");
}

// ====== SES ======
function speak(text){
  const u=new SpeechSynthesisUtterance(text);
  u.lang="tr-TR";
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

// ====== BENZERLIK ======
function score(a,b){
  a=a.toLowerCase();b=b.toLowerCase();
  let c=0;
  a.split(" ").forEach(w=>{ if(b.includes(w)) c++; });
  return c;
}

// ====== ANALIZ ======
function analyze(q){
  let best=null,bestScore=0;
  DATA.forEach(d=>{
    let s=score(q,d.a);
    if(q.includes(d.k)) s+=5;
    if(s>bestScore){best=d;bestScore=s;}
  });
  if(!best){
    speak("Eslesme bulunamadi");
    return;
  }
  const spokenCode=readStockCode(best.k);
  const text=`${best.g}. Stok kodu ${spokenCode}. Urun ${best.a}.`;
  document.getElementById("result").innerText=text;
  speak(text);
}

// ====== SES TANIMA ======
const R=window.SpeechRecognition||window.webkitSpeechRecognition;
const rec=new R();
rec.lang="tr-TR";

document.getElementById("mic").onclick=()=>{
  rec.start();
  document.getElementById("result").innerText="Dinliyorum...";
};

rec.onresult=e=>{
  const q=e.results[0][0].transcript;
  analyze(q);
};
</script>

</body>
</html>
