<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sesli Stok Asistani</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:radial-gradient(circle at top,#020617,#000);
  color:#e0f2ff;
  text-align:center;
}
h1{margin-top:20px;color:#38bdf8}

#mic{
  width:110px;height:110px;
  border-radius:50%;
  margin:20px auto;
  background:linear-gradient(145deg,#0ea5e9,#0369a1);
  display:flex;align-items:center;justify-content:center;
  font-size:48px;cursor:pointer;
  box-shadow:0 0 20px #38bdf8;
}
.listening{
  animation:pulse 1.2s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 10px #38bdf8}
  50%{box-shadow:0 0 40px #38bdf8}
  100%{box-shadow:0 0 10px #38bdf8}
}

input{
  width:90%;
  max-width:500px;
  padding:14px;
  border-radius:12px;
  border:none;
  font-size:16px;
  margin-top:10px;
}

#result{
  max-width:500px;
  margin:20px auto;
  background:#020617;
  border-radius:14px;
  padding:20px;
  font-size:16px;
  min-height:80px;
  box-shadow:inset 0 0 15px #38bdf855;
}
</style>
</head>

<body>

<h1>üéôÔ∏è Sesli Stok Asistani</h1>

<div id="mic">üé§</div>

<input id="manual" placeholder="Stok kodu veya √ºr√ºn adƒ± yaz ve Enter'a bas">

<div id="result">Hazƒ±r.</div>

<script>
// ==== VERI (ORNEK ‚Äì SENIN VERILERINLE GENISLETILECEK) ====
const DATA = [
 {g:"HAMMADDE",k:"004070201",a:"AKBIBER TANE 25 KG PP CUVAL"},
 {g:"MAMUL",k:"0800223",a:"BAHARAT KIMYON 75 GR DESTAN"},
 {g:"AMBALAJ",k:"06005",a:"SANITA JOKER KUSUZUMU 126X380X133"}
];

// ==== SAYI OKUMA ====
const ones=["","bir","iki","uc","dort","bes","alti","yedi","sekiz","dokuz"];
const tens=["","on","yirmi","otuz","kirk","elli","altmis","yetmis","seksen","doksan"];

function readNumber(n){
  let s="";
  if(n.length===2){
    if(n[0]==="0") s="sifir "+ones[n[1]];
    else s=tens[n[0]]+(n[1]!=="0"?" "+ones[n[1]]:"");
  }
  if(n.length===3){
    s=ones[n[0]]+" yuz";
    if(n.slice(1)!=="00") s+=" "+readNumber(n.slice(1));
  }
  return s.trim();
}

function readStockCode(code){
  let groups=[];
  for(let i=0;i<code.length;i+=2){
    groups.push(code.substring(i,i+2));
  }
  return groups.map(readNumber).join(" , ");
}

// ==== SES ====
function speak(text){
  const u=new SpeechSynthesisUtterance(text);
  u.lang="tr-TR";
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

// ==== AKAN YAZI ====
function typeText(el,text){
  el.innerText="";
  let i=0;
  const t=setInterval(()=>{
    el.innerText+=text[i];
    i++;
    if(i>=text.length) clearInterval(t);
  },25);
}

// ==== BENZERLIK ====
function score(q,t){
  q=q.toLowerCase();t=t.toLowerCase();
  let s=0;
  q.split(" ").forEach(w=>{ if(t.includes(w)) s++; });
  return s;
}

// ==== ANALIZ ====
function analyze(q){
  let best=null,bestScore=0;
  DATA.forEach(d=>{
    let s=score(q,d.a);
    if(q.includes(d.k)) s+=5;
    if(s>bestScore){best=d;bestScore=s;}
  });
  if(!best){
    typeText(result,"E≈üle≈üme bulunamadƒ±.");
    speak("Eslesme bulunamadi");
    return;
  }
  const spoken=readStockCode(best.k);
  const txt=`${best.g}. Stok kodu ${spoken}. Urun: ${best.a}.`;
  typeText(result,txt);
  speak(txt);
}

// ==== MANUEL GIRIS ====
manual.addEventListener("keydown",e=>{
  if(e.key==="Enter") analyze(e.target.value);
});

// ==== SES TANIMA ====
const R=window.SpeechRecognition||window.webkitSpeechRecognition;
if(R){
  const rec=new R();
  rec.lang="tr-TR";
  mic.onclick=()=>{
    mic.classList.add("listening");
    rec.start();
  };
  rec.onresult=e=>{
    mic.classList.remove("listening");
    analyze(e.results[0][0].transcript);
  };
  rec.onerror=()=>{
    mic.classList.remove("listening");
    typeText(result,"Mikrofon hatasƒ±. Yazƒ± ile deneyebilirsin.");
  };
}else{
  result.innerText="Tarayƒ±cƒ± ses tanƒ±mayƒ± desteklemiyor.";
}
</script>

</body>
</html>
